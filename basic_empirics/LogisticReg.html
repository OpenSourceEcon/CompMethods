

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>13. Logistic Regression Model &#8212; Computational Methods for Economists using Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'basic_empirics/LogisticReg';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="14. Basic Machine Learning" href="../basic_ml/ml_intro.html" />
    <link rel="prev" title="12. Basic Empirical Methods" href="BasicEmpirMethods.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/CompMethodsLogo.png" class="logo__image only-light" alt="Computational Methods for Economists using Python - Home"/>
    <script>document.write(`<img src="../_static/CompMethodsLogo.png" class="logo__image only-dark" alt="Computational Methods for Economists using Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Computational Methods for Economists using Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributor Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../contrib/contributing.html">Contributor Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding in Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../python/intro.html">1. Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/StandardLibrary.html">2. Python Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/ExceptionsIO.html">3. Exception Handling and File Input/Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/OOP.html">4. Object Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/NumPy.html">5. NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/Pandas.html">6. Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/Matplotlib.html">7. Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/SciPy.html">8. SciPy: Root finding, minimizing, interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/DocStrings.html">9. Docstrings and Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/UnitTesting.html">10. Unit Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Git and GitHub</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../git/intro.html">11. Git and GitHub</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Empirical Methods</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="BasicEmpirMethods.html">12. Basic Empirical Methods</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">13. Logistic Regression Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basic_ml/ml_intro.html">14. Basic Machine Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Neural Nets and Deep Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../deep_learn/intro.html">15. Neural Nets and Deep Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Structural Estimation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../struct_est/intro.html">16. Introduction to Structural Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../struct_est/MLE.html">17. Maximum Likelihood Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../struct_est/GMM.html">18. Generalized Method of Moments Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../struct_est/SMM.html">19. Simulated Method of Moments Estimation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix.html">Appendix</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../CompMethods_references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/OpenSourceEcon/CompMethods/blob/main/docs/book/basic_empirics/LogisticReg.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/OpenSourceEcon/CompMethods" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OpenSourceEcon/CompMethods/issues/new?title=Issue%20on%20page%20%2Fbasic_empirics/LogisticReg.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/basic_empirics/LogisticReg.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../_sources/basic_empirics/LogisticReg.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Logistic Regression Model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantitative-versus-qualitative-data">13.1. Quantitative versus Qualitative Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-classification-setting">13.1.1. The classification setting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression-classifier">13.2. Logistic Regression Classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-linear-probability-lp-model">13.2.1. The linear probability (LP) model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-logistic-logit-regression-classifier">13.2.2. The logistic (logit) regression classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinear-least-squares-estimation">13.2.2.1. Nonlinear least squares estimation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood-estimation">13.2.2.2. Maximum likelihood estimation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#titanic-example">13.2.2.3. Titanic example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-coefficients-log-odds-ratio">13.2.2.4. Interpreting coefficients (log odds ratio)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multinomial-logit">13.3. Multinomial Logit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">13.4. Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#footnotes">13.5. Footnotes</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="logistic-regression-model">
<span id="chap-logintro"></span><h1><span class="section-number">13. </span>Logistic Regression Model<a class="headerlink" href="#logistic-regression-model" title="Permalink to this heading">#</a></h1>
<p>This chapter has an executable <a class="reference external" href="https://colab.research.google.com/drive/1kNMOMvoKzuzNq_rw1yz86B3N98hgTaZ8?usp=sharing">Google Colab notebook</a> with all the same code, data references, and images. The Google Colab notebook allows you to execute the code in this chapter in the cloud so you don’t have to download Python, any of its packages, or any data to your local computer. You could manipulate and execute this notebook on any device with a browser, whether than be your computer, phone, or tablet.</p>
<p>The focus of this chapter is to give the reader a basic introduction to the logistic regression model, where it comes from, and how it can be interpreted.</p>
<section id="quantitative-versus-qualitative-data">
<span id="sec-logquantqual"></span><h2><span class="section-number">13.1. </span>Quantitative versus Qualitative Data<a class="headerlink" href="#quantitative-versus-qualitative-data" title="Permalink to this heading">#</a></h2>
<p>The linear regression models of chapter <a class="reference internal" href="BasicEmpirMethods.html#chap-basicempirmethods"><span class="std std-ref">Basic Empirical Methods</span></a> have continuous quantitative variables as dependent variables. That is, the <span class="math notranslate nohighlight">\(y_i\)</span> variable takes on a continuum of values. We use a different class of models to estimate the relationship of exogenous variables to <em>qualitative</em> or <em>categorical</em>  or <em>discrete</em> endogenous or dependent variables.</p>
<p>Examples of qualitative or categorical variables include:</p>
<ul class="simple">
<li><p>Binary variables take on two values (<span class="math notranslate nohighlight">\(J=2\)</span>), most often 0 or 1. Examples: Male or female, dead or alive, accept or reject.</p></li>
<li><p>General categorical variables can take on more than two values (<span class="math notranslate nohighlight">\(J\geq 2\)</span>). Examples: red, blue, or green; teenager, young adult, middle aged, senior.</p></li>
</ul>
<p>Note with general categorical variables that order and numerical distance do not matter. As an example let <span class="math notranslate nohighlight">\(FlowerColor_i=\{red=1, blue=2,green=3\}\)</span> be a function of <span class="math notranslate nohighlight">\(neighborhood_i\)</span>, <span class="math notranslate nohighlight">\(season_i\)</span>, and <span class="math notranslate nohighlight">\(income_i\)</span>.</p>
<div class="math notranslate nohighlight">
\[ FlowerColor_i = \beta_0 + \beta_1 neighborhood_i + \beta_2 season_i + \beta_3 income_i + u_i \]</div>
<p>We could mathematically estimate this regression model, but would that make sense? What would be wrong with a regression model?</p>
<section id="the-classification-setting">
<span id="sec-logquantqualclassset"></span><h3><span class="section-number">13.1.1. </span>The classification setting<a class="headerlink" href="#the-classification-setting" title="Permalink to this heading">#</a></h3>
<p>Let <span class="math notranslate nohighlight">\(y_i\)</span> be a qualitative dependent variable on <span class="math notranslate nohighlight">\(N\)</span> observations with <span class="math notranslate nohighlight">\(i\)</span> being the index of the observation. Each observation <span class="math notranslate nohighlight">\(y_i\)</span> can take on one of <span class="math notranslate nohighlight">\(J\)</span> discrete values <span class="math notranslate nohighlight">\(j\in\{1,2,...J\}\)</span>. Let <span class="math notranslate nohighlight">\(x_{p,i}\)</span> be the <span class="math notranslate nohighlight">\(i\)</span>th observation of the <span class="math notranslate nohighlight">\(p\)</span>th explanatory variable (independent variable) such that <span class="math notranslate nohighlight">\(X_i=\{x_{1,i}, x_{2,i}, ... x_{P,i}\}\)</span>. Then the general formulation of a classifier comes in the following two forms,</p>
<div class="math notranslate nohighlight" id="equation-eqlog-genclassmodel">
<span class="eqno">(13.1)<a class="headerlink" href="#equation-eqlog-genclassmodel" title="Permalink to this equation">#</a></span>\[    Pr(y_i=j|X_i,\theta) = f(X_i|\theta) \quad\forall i, j \quad\text{or}\quad \sum_{j=1}^J I_j(y_i=j) = f(X_i|\theta) \quad\forall i, j\]</div>
<p>where <span class="math notranslate nohighlight">\(I_j\)</span> in the second formulation is an indicator function that equals 1 when <span class="math notranslate nohighlight">\(y_i=j\)</span> and equals 0 otherwise.</p>
</section>
</section>
<section id="logistic-regression-classifier">
<span id="sec-logregclass"></span><h2><span class="section-number">13.2. </span>Logistic Regression Classifier<a class="headerlink" href="#logistic-regression-classifier" title="Permalink to this heading">#</a></h2>
<p>In this section, we will look at two models for binary (0 or 1) categorical dependent variables. We describe the first model–the linear probability (LP) model–for purely illustrative purposes. This is because the LP model has some serious shortcomings that make it almost strictly dominated by our second model in this section.</p>
<p>The second model–the logistic regression (logit, binary classifier) model–will be the focus of this section. There is another variant of this model, the probit model. But the logistic model is the more flexible, more easily interpretable, and more commonly used of the two.</p>
<section id="the-linear-probability-lp-model">
<span id="sec-loglpm"></span><h3><span class="section-number">13.2.1. </span>The linear probability (LP) model<a class="headerlink" href="#the-linear-probability-lp-model" title="Permalink to this heading">#</a></h3>
<p>One option in which a regression is barely acceptable for modeling a binary (categorical) dependent variable is the linear probability (LP) model. When the dependent variable has only two categories, it can be modeled as <span class="math notranslate nohighlight">\(y_i\in\{0,1\}\)</span> without loss of generality. Let the variable <span class="math notranslate nohighlight">\(z_i\)</span> be interpreted as the probability that <span class="math notranslate nohighlight">\(y_i=1\)</span> given the data <span class="math notranslate nohighlight">\(X_i\)</span> and parameter values <span class="math notranslate nohighlight">\(\theta=\{\beta_0,\beta_1,...\beta_P\}\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eqlog-lpm">
<span class="eqno">(13.2)<a class="headerlink" href="#equation-eqlog-lpm" title="Permalink to this equation">#</a></span>\[    z_i = Pr(y_i=1|X_i,\theta) = \beta_0 + \beta_1 x_{1,i} + \beta_2 x_{2,i} + ... \beta_P x_{P,i} + u_i\]</div>
<p>The LP model can be a nice, easy, computationally convenient way to estimate the probability of outcome <span class="math notranslate nohighlight">\(y_i=1\)</span>. This could also be reinterpreted, without loss of generality, as the probability that <span class="math notranslate nohighlight">\(y_i=0\)</span>. This is equivalent to a redefinition of which outcome is defined as <span class="math notranslate nohighlight">\(y_i=1\)</span>.</p>
<p>The main drawback of the LP model is that the predicted values of the probability that <span class="math notranslate nohighlight">\(y_i=1\)</span> or <span class="math notranslate nohighlight">\(Pr(y_i=1|X_i,\theta)\)</span> can be greater than 1 and can be less than 0. It is for this reason that it is very difficult to publish any research based on an LP model.</p>
</section>
<section id="the-logistic-logit-regression-classifier">
<span id="sec-loglogit"></span><h3><span class="section-number">13.2.2. </span>The logistic (logit) regression classifier<a class="headerlink" href="#the-logistic-logit-regression-classifier" title="Permalink to this heading">#</a></h3>
<p>In contrast to the linear probability model, a good classifier tranforms numerical values from explanatory variables or feature variables into a probability that is strictly between 0 and 1. More specifically this function must take any numer on the real line between <span class="math notranslate nohighlight">\(-\infty\)</span> and <span class="math notranslate nohighlight">\(\infty\)</span> and map it to the <span class="math notranslate nohighlight">\([0,1]\)</span> interval. In addition, we want a monotonically increasing relationship between <span class="math notranslate nohighlight">\(x\)</span> and the function <span class="math notranslate nohighlight">\(f(x)\)</span>. What are some functions with this property? Candidates include the following functions.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f(x)=\text{max}\Bigl(0, \,\text{min}\bigl(1, x\bigr)\Bigr)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f(x)=\frac{e^x}{1 + e^x}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f(x) = \arctan(x)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f(x) = \text{cdf}(x)\)</span></p></li>
</ul>
<p>Why don’t functions like <span class="math notranslate nohighlight">\(\sin(x)\)</span>, <span class="math notranslate nohighlight">\(\cos(x)\)</span>, and <span class="math notranslate nohighlight">\(\frac{|x|}{1+|x|}\)</span> fit these criteria?</p>
<p>The second function in the bulletted list above is the logistic function. The logistic regression model is a binary dependent variable classifier that constrains its predicted values to be stricly between 0 and 1. The logistic function is the following,</p>
<div class="math notranslate nohighlight" id="equation-eqlog-logistic">
<span class="eqno">(13.3)<a class="headerlink" href="#equation-eqlog-logistic" title="Permalink to this equation">#</a></span>\[    f(x) = \frac{e^x}{1 + e^x} \quad\forall x\]</div>
<p>and has the following general shape.</p>
<div class="cell tag_hide-input tag_remove_output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x_vals</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Logistic function for $x\in[-6,6]$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$ values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f(x)$ values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="figlogit-logit-gen">
<a class="reference internal image-reference" href="../_images/logit_gen.png"><img alt="../_images/logit_gen.png" src="../_images/logit_gen.png" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13.1 </span><span class="caption-text">Logistic function for <span class="math notranslate nohighlight">\(x\in[-6,6]\)</span></span><a class="headerlink" href="#figlogit-logit-gen" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The logistic regression function is the specific case of the logistic function where the value of <span class="math notranslate nohighlight">\(x\)</span> in the general logistic function <a class="reference internal" href="#equation-eqlog-logistic">(13.3)</a> is replaced by a linear combination of variables <span class="math notranslate nohighlight">\(\beta_0 + \beta_1 x_{1,i} + ...\beta_P x_{P,i}\)</span> similar to a linear regression model.</p>
<div class="math notranslate nohighlight" id="equation-eqlog-logit-std">
<span class="eqno">(13.4)<a class="headerlink" href="#equation-eqlog-logit-std" title="Permalink to this equation">#</a></span>\[    Pr(y_i=1|X_i,\theta) = \frac{e^{X_i\beta}}{1 + e^{X_i\beta}} = \frac{e^{\beta_0 + \beta_1 x_{1,i} + ...\beta_P x_{P,i}}}{1 + e^{\beta_0 + \beta_1 x_{1,i} + ...\beta_P x_{P,i}}}\]</div>
<p>or equivalently</p>
<div class="math notranslate nohighlight" id="equation-eqlog-logit-neg">
<span class="eqno">(13.5)<a class="headerlink" href="#equation-eqlog-logit-neg" title="Permalink to this equation">#</a></span>\[    Pr(y_i=1|X_i,\theta) = \frac{1}{1 + e^{-X_i\beta}} = \frac{1}{1 + e^{-(\beta_0 + \beta_1 x_{1,i} + ...\beta_P x_{P,i})}}\]</div>
<p>We could estimate the paramters <span class="math notranslate nohighlight">\(\theta=\{\beta_0,\beta_1,...\beta_P\}\)</span> by generalized method of moments (GMM) using nonlinear least squares or a more general set of moments to match.<a class="footnote-reference brackets" href="#gmm" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> But maximum likelihood estimation is the most common method for estimating the parameters <span class="math notranslate nohighlight">\(\theta\)</span> because of its more robust statistical properties.<a class="footnote-reference brackets" href="#maxlikeli" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> Also, the distributional assumptions are built into the model, so they are not overly strong.</p>
<section id="nonlinear-least-squares-estimation">
<span id="sec-loglogitnlls"></span><h4><span class="section-number">13.2.2.1. </span>Nonlinear least squares estimation<a class="headerlink" href="#nonlinear-least-squares-estimation" title="Permalink to this heading">#</a></h4>
<p>If we define <span class="math notranslate nohighlight">\(z_i = Pr(y_i=1|X_i,\theta)\)</span>, then the error in the logistic regression is the following.</p>
<div class="math notranslate nohighlight" id="equation-eqlog-logitnlls-err">
<span class="eqno">(13.6)<a class="headerlink" href="#equation-eqlog-logitnlls-err" title="Permalink to this equation">#</a></span>\[    \varepsilon_i = y_i - z_i\]</div>
<p>The GMM specification of the nonlinear least squares method of estimating the parameter vector <span class="math notranslate nohighlight">\(\theta\)</span> would then be the following.<a class="footnote-reference brackets" href="#gmm" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<div class="math notranslate nohighlight" id="equation-eqlog-logitnlls-gmm">
<span class="eqno">(13.7)<a class="headerlink" href="#equation-eqlog-logitnlls-gmm" title="Permalink to this equation">#</a></span>\[\begin{split}    \begin{split}
      \hat{\theta}_{nlls} = \theta:\quad &amp;\min_{\theta} \sum_{i=1}^N\varepsilon_i^2 \quad = \quad \min_{\theta}\sum_{i=1}^N\bigl(y_i - z_i \bigr)^2 \quad \\
      &amp;= \quad \min_{\theta} \sum_{i=1}^N\Bigl[y_i - Pr(y_i=1|X_i,\theta)\Bigr]^2
    \end{split}\end{split}\]</div>
</section>
<section id="maximum-likelihood-estimation">
<span id="sec-loglogitmle"></span><h4><span class="section-number">13.2.2.2. </span>Maximum likelihood estimation<a class="headerlink" href="#maximum-likelihood-estimation" title="Permalink to this heading">#</a></h4>
<p>We characterized the general likelihood function for a sample of data as the probability that the given sample <span class="math notranslate nohighlight">\((y_i,X_i)\)</span> came from the assumed distribution given parameter values <span class="math notranslate nohighlight">\(Pr(y_i=1|X_i,\theta)\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eqlog-logitmle-like">
<span class="eqno">(13.8)<a class="headerlink" href="#equation-eqlog-logitmle-like" title="Permalink to this equation">#</a></span>\[    \mathcal{L}(y_i,X_i|\theta) = \prod_{i=1}^N Pr(y_i=1|X_i,\theta)^{y_i}\bigl[1 - Pr(y_i=1|X_i,\theta)\bigr]^{1 - y_i}\]</div>
<p>The intuition of this likelihood function is that you want the probability of the observations for which <span class="math notranslate nohighlight">\(y_i=1\)</span> to be close to one <span class="math notranslate nohighlight">\(Pr(X)\)</span>, and you want the probability of the observations for which <span class="math notranslate nohighlight">\(y_i=0\)</span> to also be close to one <span class="math notranslate nohighlight">\(1 - Pr(X)\)</span>.</p>
<p>The log-likelihood function, which the MLE problem maximizes is the following.</p>
<div class="math notranslate nohighlight" id="equation-eqlog-logitmle-loglike">
<span class="eqno">(13.9)<a class="headerlink" href="#equation-eqlog-logitmle-loglike" title="Permalink to this equation">#</a></span>\[    \ln\bigl[\mathcal{L}(y_i,X_i|\theta)\bigr] = \sum_{i=1}^N\Bigl(y_i\ln\bigl[Pr(y_i=1|X_i,\theta)\bigr] + (1 - y_i)\ln\bigl[1 - Pr(y_i=1|X_i,\theta)\bigr]\Bigr)\]</div>
<p>The MLE problem for estimating <span class="math notranslate nohighlight">\(\theta\)</span> of the logistic regression model is, therefore, the following.<a class="footnote-reference brackets" href="#maxlikeli" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<div class="math notranslate nohighlight" id="equation-eqlog-logitmle-maxprob">
<span class="eqno">(13.10)<a class="headerlink" href="#equation-eqlog-logitmle-maxprob" title="Permalink to this equation">#</a></span>\[    \hat{\theta}_{mle} = \theta:\quad \max_{\theta} \ln\bigl[\mathcal{L}(y_i,X_i|\theta)\bigr]\]</div>
</section>
<section id="titanic-example">
<span id="sec-loglogittitanic"></span><h4><span class="section-number">13.2.2.3. </span>Titanic example<a class="headerlink" href="#titanic-example" title="Permalink to this heading">#</a></h4>
<p>A good example of logistic regression comes from a number of sources. But I am adapting some code and commentary from <a class="reference external" href="http://www.data-mania.com/blog/logistic-regression-example-in-python/">http://www.data-mania.com/blog/logistic-regression-example-in-python/</a>. The research question is to use a famous Titanic passenger dataset to try to identify the characteristics that most predict whether you survived <span class="math notranslate nohighlight">\(y_i=1\)</span> or died <span class="math notranslate nohighlight">\(y_i=0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">url</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/OpenSourceEcon/CompMethods/&#39;</span> <span class="o">+</span>
      <span class="s1">&#39;main/data/basic_empirics/logit/titanic-train.csv&#39;</span><span class="p">)</span>
<span class="n">titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;SibSp&#39;</span><span class="p">,</span> <span class="s1">&#39;Parch&#39;</span><span class="p">,</span> <span class="s1">&#39;Ticket&#39;</span><span class="p">,</span> <span class="s1">&#39;Fare&#39;</span><span class="p">,</span> <span class="s1">&#39;Cabin&#39;</span><span class="p">,</span> <span class="s1">&#39;Embarked&#39;</span><span class="p">]</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>446.000000</td>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
    </tr>
    <tr>
      <th>std</th>
      <td>257.353842</td>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>223.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>446.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>668.500000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>891.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The variable descriptions are the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Survived</span></code>: Survival (0 = No; 1 = Yes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pclass</span></code>: Passenger class (1 = 1st; 2 = 2nd; 3 = 3rd)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Name</span></code>: Name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Sex</span></code>: Gender</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Age</span></code>: Age</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SibSp</span></code>: Number of siblings/spouses aboard</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Parch</span></code>: Number of parents/children aboard</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ticket</span></code>: Ticket number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Fare</span></code>: Passenger fare (British pound)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cabin</span></code>: Cabin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Embarked</span></code>: Port of embarkation (C = Cherbourg; Q = Queenstown; S = Southampton)</p></li>
</ul>
<p>Let’s first check that our target variable, <code class="docutils literal notranslate"><span class="pre">Survived</span></code>, is binary. Since we are building a model to predict survival of passangers from the Titanic, our target is going to be the <code class="docutils literal notranslate"><span class="pre">Survived</span></code> variable from the titanic dataframe. To make sure that it is a binary variable, let’s use Panda’s <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code> method and plot the counts in a <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> bar chart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Survived
0    549
1    342
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categories</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">vbars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;0: Did not survive&quot;</span><span class="p">,</span> <span class="s2">&quot;1: Survived&quot;</span><span class="p">],</span> <span class="n">counts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">vbars</span><span class="p">,</span> <span class="n">label_type</span><span class="o">=</span><span class="s2">&quot;edge&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Counts for 0 and 1 for Survived variable&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Survived&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="figlogit-survived-count">
<a class="reference internal image-reference" href="../_images/survived_count.png"><img alt="../_images/survived_count.png" src="../_images/survived_count.png" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13.2 </span><span class="caption-text">Counts for 0 and 1 for Survived variable</span><a class="headerlink" href="#figlogit-survived-count" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We can check for missing values in the DataFrame. It is easy to check for missing values by calling the <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> method, and the <code class="docutils literal notranslate"><span class="pre">sum()</span></code> method off of the DataFrame to return a tally of all the <code class="docutils literal notranslate"><span class="pre">True</span></code> values that are returned by the <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age            177
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         2
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>How many observations are there in the DataFrame?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          714 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB
</pre></div>
</div>
</div>
</div>
<p><strong>Model selection and missing values</strong></p>
<p>The variable <code class="docutils literal notranslate"><span class="pre">Cabin</span></code> is missing data in the majority of its observations, so we should not include that in our analysis (although that would be an interesting variable to have). We can also probably exclude <code class="docutils literal notranslate"><span class="pre">Name</span></code>, <code class="docutils literal notranslate"><span class="pre">Ticket</span></code> (ticket number). But we will include all the other variables.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Survived</span></code>: This variable is obviously relevant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pclass</span></code>: Does a passenger’s class on the boat affect their survivability?</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Sex</span></code>: Could a passenger’s gender impact their survival rate?</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Age</span></code>: Does a person’s age impact their survival rate?</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SibSp</span></code>: Does the number of relatives on the boat (that are siblings or a spouse) affect a person survivability? Probably.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Parch</span></code>: Does the number of relatives on the boat (that are children or parents) affect a person survivability? Probably.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Fare</span></code>: Does the fare a person paid effect his survivability? Maybe.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Embarked</span></code>: Does a person’s point of embarkation matter? It depends on how the boat was filled.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic_data</span> <span class="o">=</span> <span class="n">titanic</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">,</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;Ticket&#39;</span><span class="p">,</span><span class="s1">&#39;Cabin&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">titanic_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we have the dataframe reduced down to only relevant variables, but now we need to deal with the missing values in the age variable.</p>
<p><strong>Imputing missing values</strong></p>
<p>Let’s look at how passenger age is related to their class as a passenger on the boat.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic_data</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pclass
3    491
1    216
2    184
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of three NumPy arrays of Age data by Pclass</span>
<span class="n">age_by_pclass_dtalst</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pclass_val</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">age_by_pclass_vec</span> <span class="o">=</span> <span class="n">titanic_data</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">][</span>
        <span class="n">titanic_data</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">pclass_val</span>
    <span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="c1"># Have to remove nan values for the boxplot to work</span>
    <span class="n">age_by_pclass_vec_nonan</span> <span class="o">=</span> <span class="n">age_by_pclass_vec</span><span class="p">[</span>
        <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">age_by_pclass_vec</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">age_by_pclass_dtalst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">age_by_pclass_vec_nonan</span><span class="p">)</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1: First class&quot;</span><span class="p">,</span> <span class="s2">&quot;2: Second class&quot;</span><span class="p">,</span> <span class="s2">&quot;3: Third class&quot;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">boxplot1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">age_by_pclass_dtalst</span><span class="p">,</span>
    <span class="n">notch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Notch shape</span>
    <span class="n">vert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Vertical box alignment</span>
    <span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Fill boxes with color</span>
    <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show the mean value as a scatter point in each box</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Box and whisker plots for age by passenger class&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Passenger class ($Pclass$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>

<span class="c1"># fill boxes with colors</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">patch</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">boxplot1</span><span class="p">[</span><span class="s1">&#39;boxes&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="figlogit-age-boxplot">
<a class="reference internal image-reference" href="../_images/age_boxplot.png"><img alt="../_images/age_boxplot.png" src="../_images/age_boxplot.png" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13.3 </span><span class="caption-text">Box and whisker plots for age by passenger class</span><a class="headerlink" href="#figlogit-age-boxplot" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The box and whisker plots in <a class="reference internal" href="#figlogit-age-boxplot"><span class="std std-numref">Figure 13.3</span></a> are a nice way to visualize where the data live. The two ends of the colored box show the first quartile (25th percentil) to the third quartile (75th percentile), with the notched line representing the median (50th percentile). A scatter point great triangle shows the mean. The whiskers extend to 1.5x the inter-quartile range (IQR) of ages, with outliers beyond the whiskers shown as scatter points. An alternative would be to show a histogram.</p>
<p>Roughly speaking, we could say that the younger a passenger is, the more likely they are to be in 3rd class. The older a passenger is, the more likely they are to be in 1st class. So there is a loose relationship between these variables. So let’s write a function that approximates a passengers age, based on their class. From the box plot, it looks like the average age of 1st class passengers is about 37, 2nd class passengers is 29, and 3rd class pasengers is 24.</p>
<p>So let’s write a function that finds each null value in the <code class="docutils literal notranslate"><span class="pre">Age</span></code> variable, and for each null, checks the value of the Pclass and assigns an age value according to the average age of passengers in that class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">median_ages</span> <span class="o">=</span> <span class="n">titanic_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Pclass&quot;</span><span class="p">)[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Create new variable Age_imputed and impute the median ages for missing values</span>
<span class="n">titanic_data</span><span class="p">[</span><span class="s2">&quot;Age_imputed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">titanic_data</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pclass_val</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">row_indexer</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">titanic_data</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">*</span> <span class="n">titanic_data</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pclass_val</span>
    <span class="p">)</span>
    <span class="n">titanic_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_indexer</span><span class="p">,</span> <span class="s2">&quot;Age_imputed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">median_ages</span><span class="p">[</span><span class="n">pclass_val</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">imputed_obs</span> <span class="o">=</span> <span class="n">row_indexer</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imputed&quot;</span><span class="p">,</span> <span class="n">imputed_obs</span><span class="p">,</span> <span class="s2">&quot;Age values with Pclass=&quot;</span><span class="p">,</span> <span class="n">pclass_val</span><span class="p">)</span>

<span class="n">titanic_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imputed 30 Age values with Pclass= 1
Imputed 11 Age values with Pclass= 2
Imputed 136 Age values with Pclass= 3
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Survived         0
Pclass           0
Sex              0
Age            177
SibSp            0
Parch            0
Fare             0
Embarked         2
Age_imputed      0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>There are 2 null values in the <code class="docutils literal notranslate"><span class="pre">Embarked</span></code> variable. We can drop those 2 records without loosing too much important information from our dataset, so we will do that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">titanic_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Survived       0
Pclass         0
Sex            0
Age            0
SibSp          0
Parch          0
Fare           0
Embarked       0
Age_imputed    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Embarked</th>
      <th>Age_imputed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>35.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Converting categorical variables to a dummy indicators</strong></p>
<p>The next thing we need to do is reformat our variables so that they work with the model. Specifically, we need to reformat the <code class="docutils literal notranslate"><span class="pre">Sex</span></code> and <code class="docutils literal notranslate"><span class="pre">Embarked</span></code> variables into numeric categorical variables.</p>
</section>
<section id="interpreting-coefficients-log-odds-ratio">
<span id="sec-loglogitinterpret"></span><h4><span class="section-number">13.2.2.4. </span>Interpreting coefficients (log odds ratio)<a class="headerlink" href="#interpreting-coefficients-log-odds-ratio" title="Permalink to this heading">#</a></h4>
<p>The odds ratio in the logistic model is provides a nice way to interpret logit model coefficients. Let <span class="math notranslate nohighlight">\(z\equiv X^T\beta = \beta_0 + \beta_1 x_{1,i} + ...\beta_K x_{K,i}\)</span>. The logistic model is stated by the probability that the binary categorical dependent variable equals one <span class="math notranslate nohighlight">\(y_i=1\)</span>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-7eb4d494-606a-47ab-9eb0-eed991b44ae1">
<span class="eqno">(13.11)<a class="headerlink" href="#equation-7eb4d494-606a-47ab-9eb0-eed991b44ae1" title="Permalink to this equation">#</a></span>\[\begin{equation}
  P(y_i=1|X,\theta) = \frac{e^z}{1 + e^z}
\end{equation}\]</div>
<p>Given this equation, we know that the probability of the dependent variable being zero <span class="math notranslate nohighlight">\(y_i=0\)</span> is just one minus the probability above.</p>
<div class="amsmath math notranslate nohighlight" id="equation-cf5d2560-a1e5-4f72-a83c-1fad863826e1">
<span class="eqno">(13.12)<a class="headerlink" href="#equation-cf5d2560-a1e5-4f72-a83c-1fad863826e1" title="Permalink to this equation">#</a></span>\[\begin{equation}
  P(y_i=0|X,\theta) = 1 - P(y_i=1|X,\theta) = 1 - \frac{e^z}{1 + e^z} = \frac{1}{1 + e^z}
\end{equation}\]</div>
<p>The odds ratio is a common way of expressing the probability of an event versus all other events. For example, if the probability of your favorite team winning a game is <span class="math notranslate nohighlight">\(P(win)=0.8\)</span>, then we know that the probability of your favorite team losing that game is <span class="math notranslate nohighlight">\(P(lose)=1-P(win)=0.2\)</span>. The odds ratio is the ratio of these two probabilities.</p>
<div class="amsmath math notranslate nohighlight" id="equation-be142f30-8169-4a82-b0dd-c07f04085577">
<span class="eqno">(13.13)<a class="headerlink" href="#equation-be142f30-8169-4a82-b0dd-c07f04085577" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \frac{P(win)}{P(lose)} = \frac{P(win)}{1 - P(win)} = \frac{0.8}{0.2} = \frac{4}{1} \quad\text{or}\quad 4
\end{equation}\]</div>
<p>The odds ratio tells you that the probability of your team winning is four times as likely as your team losing. A gambler would say that your odds are 4-to-1. Another way of saying it is that your team will win four out of five times and will lose 1 out of five times.</p>
<p>In the logistic model, the odds ratio reduces the problem nicely.</p>
<div class="amsmath math notranslate nohighlight" id="equation-90db65c6-a78c-496e-9a8c-eb52e643658d">
<span class="eqno">(13.14)<a class="headerlink" href="#equation-90db65c6-a78c-496e-9a8c-eb52e643658d" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \frac{P(y_i=1|X,\theta)}{1 - P(y_i=1|X,\theta)} = \frac{\frac{e^z}{1 + e^z}}{\frac{1}{1 + e^z}} = e^z
\end{equation}\]</div>
<p>If we take the log of both sides, we see that the log odds ratio is equal to the linear predictor <span class="math notranslate nohighlight">\(z\equiv X^T\beta = \beta_0 + \beta_1 x_{1,i} + ...\beta_K x_{K,i}\)</span>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-011d17b4-5d84-4f58-bbed-66c5ae2fa404">
<span class="eqno">(13.15)<a class="headerlink" href="#equation-011d17b4-5d84-4f58-bbed-66c5ae2fa404" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \ln\left(\frac{P(y_i=1|X,\theta)}{1 - P(y_i=1|X,\theta)}\right) = z = \beta_0 + \beta_1 x_{1,i} + ...\beta_K x_{K,i}
\end{equation}\]</div>
<p>So the interpretation of the coeficients <span class="math notranslate nohighlight">\(\beta_k\)</span> is that a one-unit increase of the variable <span class="math notranslate nohighlight">\(x_{k,i}\)</span> increases the odds ratio or the odds of <span class="math notranslate nohighlight">\(y_i=1\)</span> by <span class="math notranslate nohighlight">\(\beta_{k,i}\)</span> percent.</p>
</section>
</section>
</section>
<section id="multinomial-logit">
<span id="sec-logmultinomlogit"></span><h2><span class="section-number">13.3. </span>Multinomial Logit<a class="headerlink" href="#multinomial-logit" title="Permalink to this heading">#</a></h2>
<p>The multinomial logit model is a natural extension of the logit model. In contrast to the logit model in which the dependent variable has only two categories, the multinomial logit model accomodates <span class="math notranslate nohighlight">\(J\geq2\)</span> categories in the dependent variable. Let <span class="math notranslate nohighlight">\(\eta_j\)</span> be the linear predictor for the <span class="math notranslate nohighlight">\(j\)</span>th category.
$<span class="math notranslate nohighlight">\( \eta_j\equiv \beta_{j,0} + \beta_{j,1}x_{1,i} + ...\beta_{j,K}x_{K,i} \quad\forall y_i = j \)</span>$</p>
<p>The multinomial logit model gives the probability of <span class="math notranslate nohighlight">\(y_i=j\)</span> relative to some reference category <span class="math notranslate nohighlight">\(J\)</span> that is left out.</p>
<div class="amsmath math notranslate nohighlight" id="equation-6aefc6f8-4362-4f49-bfc2-3fa1f182ef3b">
<span class="eqno">(13.16)<a class="headerlink" href="#equation-6aefc6f8-4362-4f49-bfc2-3fa1f182ef3b" title="Permalink to this equation">#</a></span>\[\begin{equation}
  Pr(y_i=j|X,\theta) = \frac{e^{\eta_j}}{1 + \sum_v^{J-1}e^{\eta_v}} \quad\text{for}\quad 1\leq j\leq J-1
\end{equation}\]</div>
<p>Once the <span class="math notranslate nohighlight">\(J-1\)</span> sets of coefficients are estimated, the final <span class="math notranslate nohighlight">\(J\)</span>th set of coefficients are a residual based on the following expression.</p>
<div class="amsmath math notranslate nohighlight" id="equation-91dcb7d5-2020-4fea-b29e-95a670fec8ff">
<span class="eqno">(13.17)<a class="headerlink" href="#equation-91dcb7d5-2020-4fea-b29e-95a670fec8ff" title="Permalink to this equation">#</a></span>\[\begin{equation}
  Pr(y_i=J|X,\theta) = \frac{1}{1 + \sum_v^{J-1}e^{\eta_v}}
\end{equation}\]</div>
<p>The analogous log odds ratio interpretation applies to the multinomial logit model.</p>
<div class="amsmath math notranslate nohighlight" id="equation-4ed91ef4-f30d-419e-8c38-a174865488fb">
<span class="eqno">(13.18)<a class="headerlink" href="#equation-4ed91ef4-f30d-419e-8c38-a174865488fb" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \ln\left(\frac{Pr(y_i=j|X,\theta)}{Pr(y_i=J|X,\theta)}\right) = \eta_j = \beta_{j,0} + \beta_{j,1}x_{1,i} + ...\beta_{j,K}x_{K,i} \quad\text{for}\quad 1\leq j \leq J-1
\end{equation}\]</div>
<p>This is the odds ratio of <span class="math notranslate nohighlight">\(y_i=j\)</span> relative to <span class="math notranslate nohighlight">\(y_i=J\)</span>. The interpretation of the <span class="math notranslate nohighlight">\(\beta_{j,k}\)</span> coefficient is the predicted percentage change in the log odds ratio of <span class="math notranslate nohighlight">\(y_i=j\)</span> to <span class="math notranslate nohighlight">\(y_i=J\)</span> from a one-unit increase in variable <span class="math notranslate nohighlight">\(x_{k,i}\)</span>.</p>
<p>TODO: list code for Iris example</p>
</section>
<section id="exercises">
<span id="sec-logexercises"></span><h2><span class="section-number">13.4. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<p>Put exercises here.</p>
</section>
<section id="footnotes">
<span id="seclogfootnotes"></span><h2><span class="section-number">13.5. </span>Footnotes<a class="headerlink" href="#footnotes" title="Permalink to this heading">#</a></h2>
<p>The footnotes from this chapter.</p>
<hr class="footnotes docutils" />
<aside class="footnote brackets" id="gmm" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p>See the <a class="reference internal" href="../struct_est/GMM.html#chap-gmm"><span class="std std-ref">Generalized Method of Moments Estimation</span></a> chapter of this book.</p>
</aside>
<aside class="footnote brackets" id="maxlikeli" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id4">2</a>)</span>
<p>See the <a class="reference internal" href="../struct_est/MLE.html#chap-mle"><span class="std std-ref">Maximum Likelihood Estimation</span></a> chapter of this book.</p>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./basic_empirics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="BasicEmpirMethods.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">12. </span>Basic Empirical Methods</p>
      </div>
    </a>
    <a class="right-next"
       href="../basic_ml/ml_intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">14. </span>Basic Machine Learning</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantitative-versus-qualitative-data">13.1. Quantitative versus Qualitative Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-classification-setting">13.1.1. The classification setting</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression-classifier">13.2. Logistic Regression Classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-linear-probability-lp-model">13.2.1. The linear probability (LP) model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-logistic-logit-regression-classifier">13.2.2. The logistic (logit) regression classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinear-least-squares-estimation">13.2.2.1. Nonlinear least squares estimation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood-estimation">13.2.2.2. Maximum likelihood estimation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#titanic-example">13.2.2.3. Titanic example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-coefficients-log-odds-ratio">13.2.2.4. Interpreting coefficients (log odds ratio)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multinomial-logit">13.3. Multinomial Logit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">13.4. Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#footnotes">13.5. Footnotes</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Richard W. Evans
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>