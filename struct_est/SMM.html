

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Simulated Method of Moments Estimation &#8212; Computational Methods for Economists using Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'struct_est/SMM';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Glossary" href="../appendix/glossary.html" />
    <link rel="prev" title="Generalized Method of Moments Estimation" href="GMM.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/CompMethodsLogo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/CompMethodsLogo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Computational Methods for Economists using Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributor Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../contrib/contributing.html">Contributor Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding in Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../python/intro.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/StandardLibrary.html">Python Standard Library</a></li>

<li class="toctree-l1"><a class="reference internal" href="../python/OOP.html">Object Oriented Programming</a></li>

<li class="toctree-l1"><a class="reference internal" href="../python/NumPy.html">NumPy</a></li>

<li class="toctree-l1"><a class="reference internal" href="../python/Pandas.html">Pandas</a></li>

<li class="toctree-l1"><a class="reference internal" href="../python/Matplotlib.html">Matplotlib</a></li>

<li class="toctree-l1"><a class="reference internal" href="../python/SciPy.html">SciPy</a></li>

<li class="toctree-l1"><a class="reference internal" href="../python/DocStrings.html">Docstrings and Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/UnitTesting.html">Unit Testing</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Git and GitHub</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../git/intro.html">Git and GitHub</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Causal Inference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../caus_inf/intro.html">Basic Causal Inference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basic_ml/intro.html">Basic Machine Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Neural Nets and Deep Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../deep_learn/intro.html">Neural Nets and Deep Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Structural Estimation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Structural Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="MaxLikelihood.html">Maximum Likelihood Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GMM.html">Generalized Method of Moments Estimation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Simulated Method of Moments Estimation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/intro.html">Appendix</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../CompMethods_references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/OpenSourceEcon/CompMethods" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/OpenSourceEcon/CompMethods/issues/new?title=Issue%20on%20page%20%2Fstruct_est/SMM.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/struct_est/SMM.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Simulated Method of Moments Estimation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-smm-estimator">The SMM estimator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-weighting-matrix-w">The Weighting Matrix (W)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-identity-matrix-w-i">The identity matrix (W=I)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-step-variance-covariance-estimator-of-w">Two-step variance-covariance estimator of W</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterated-variance-covariance-estimator-of-w">Iterated variance-covariance estimator of W</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#newey-west-consistent-estimator-of-omega-and-w">Newey-West consistent estimator of <span class="math notranslate nohighlight">\(\Omega\)</span> and W</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-smm-variance-covariance-estimator-of-the-estimated-parameters">The SMM Variance-Covariance Estimator of the Estimated Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#footnotes">Footnotes</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="simulated-method-of-moments-estimation">
<span id="chap-smm"></span><h1>Simulated Method of Moments Estimation<a class="headerlink" href="#simulated-method-of-moments-estimation" title="Permalink to this heading">#</a></h1>
<p>This chapter describes the simulated method of moments (SMM) estimation method. All data and images from this chapter can be found in the data directory (<a class="reference external" href="https://github.com/OpenSourceEcon/CompMethods/tree/main/data/smm/">./data/smm/</a>) and images directory (<a class="reference external" href="https://github.com/OpenSourceEcon/CompMethods/tree/main/images/smm/">./images/smm/</a>) for the GitHub repository for this online book.</p>
<section id="the-smm-estimator">
<span id="secsmmestimator"></span><h2>The SMM estimator<a class="headerlink" href="#the-smm-estimator" title="Permalink to this heading">#</a></h2>
<p>Simulated method of moments (SMM) is analogous to the generalized method of moments (GMM) estimator. SMM could really be thought of as a particular type of GMM estimator. The SMM estimator chooses a vector of model parameters <span class="math notranslate nohighlight">\(\theta\)</span> to make simulated model moments match data moments. Seminal papers developing SMM are <span id="id1">[<a class="reference internal" href="../CompMethods_references.html#id16" title="Daniel McFadden. A method of simulated moments for estimation of discrete response models without numerical integration. Econometrica, 57(5):995-1026, September 1989.">McFadden, 1989</a>]</span>, <span id="id2">[<a class="reference internal" href="../CompMethods_references.html#id15" title="Bong-Soo Lee and Beth Fisher Ingram. Simulation estimation of time series models. Journal of Econometrics, 47(2-3):197-205, February 1991.">Lee and Ingram, 1991</a>]</span>, and <span id="id3">[<a class="reference internal" href="../CompMethods_references.html#id6" title="Darrell Duffie and Kenneth J. Singleton. Simulated moment estimation of markov models of asset prices. Econometrica, 61(4):929-952, July 1993.">Duffie and Singleton, 1993</a>]</span>. Good textbook treatments of SMM are found in <span id="id4">[<a class="reference internal" href="../CompMethods_references.html#id2" title="Jérôme Adda and Russell Cooper. Dynamic Economics: Quantitative Methods and Applications. MIT Press, 2003.">Adda and Cooper, 2003</a>]</span>, (pp. 87-100) and <span id="id5">[<a class="reference internal" href="../CompMethods_references.html#id5" title="Russell Davidson and James G. MacKinnon. Econometric Theory and Methods. Oxford University Press, 2004.">Davidson and MacKinnon, 2004</a>]</span>, (pp. 383-394).</p>
<p>Let the data be represented, in general, by <span class="math notranslate nohighlight">\(x\)</span>. This could have many variables, and it could be cross-sectional or time series. We define the estimation problem as one in which we want to model the data <span class="math notranslate nohighlight">\(x\)</span> using some parameterized model <span class="math notranslate nohighlight">\(g(x|\theta)\)</span> in which <span class="math notranslate nohighlight">\(\theta\)</span> is a <span class="math notranslate nohighlight">\(K\times 1\)</span> vector of parameters.</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-thetavec">
<span class="eqno">(2)<a class="headerlink" href="#equation-eqsmm-thetavec" title="Permalink to this equation">#</a></span>\[    \theta \equiv \left[\theta_1, \theta_2, ...\theta_K\right]^T\]</div>
<p>In the <a class="reference internal" href="MaxLikelihood.html#chap-maxlikeli"><span class="std std-ref">Maximum Likelihood Estimation</span></a> chapter, we used data <span class="math notranslate nohighlight">\(x\)</span> and model parameters <span class="math notranslate nohighlight">\(\theta\)</span> to maximize the likelihood of drawing that data <span class="math notranslate nohighlight">\(x\)</span> from the model given parameters <span class="math notranslate nohighlight">\(\theta\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-mlestimator">
<span class="eqno">(3)<a class="headerlink" href="#equation-eqsmm-mlestimator" title="Permalink to this equation">#</a></span>\[    \hat{\theta}_{ML} = \theta:\quad \max_{\theta}\ln\mathcal{L} = \sum_{i=1}^N\ln\Bigl(f(x_i|\theta)\Bigr)\]</div>
<p>where <span class="math notranslate nohighlight">\(f(x_i|\theta)\)</span> is the likelihood of seeing observation <span class="math notranslate nohighlight">\(x_i\)</span> in the data <span class="math notranslate nohighlight">\(x\)</span> given vector of parameters <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>In the <a class="reference internal" href="GMM.html#chap-gmm"><span class="std std-ref">Generalized Method of Moments Estimation</span></a> chapter, we used data <span class="math notranslate nohighlight">\(x\)</span> and the <span class="math notranslate nohighlight">\(K\times 1\)</span> vector of model parameters <span class="math notranslate nohighlight">\(\theta\)</span> to minimize the distance between the vector of <span class="math notranslate nohighlight">\(R\geq K\)</span> model moments <span class="math notranslate nohighlight">\(m(x|\theta)\)</span> and data moments <span class="math notranslate nohighlight">\(m(x)\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-gmmestimator">
<span class="eqno">(4)<a class="headerlink" href="#equation-eqsmm-gmmestimator" title="Permalink to this equation">#</a></span>\[    \hat{\theta}_{GMM} = \theta:\quad \min_{\theta}||m(x|\theta) - m(x)||\]</div>
<p>where,</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-modmomfuncvecgen">
<span class="eqno">(5)<a class="headerlink" href="#equation-eqsmm-modmomfuncvecgen" title="Permalink to this equation">#</a></span>\[    m(x|\theta) \equiv \left[m_1(x|\theta), m_2(x|\theta),...m_R(x|\theta)\right]^T\]</div>
<p>and,</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-datamomfuncvecgen">
<span class="eqno">(6)<a class="headerlink" href="#equation-eqsmm-datamomfuncvecgen" title="Permalink to this equation">#</a></span>\[    m(x)\equiv \left[m_1(x), m_2(x), ...m_R(x)\right]^T\]</div>
<p>The following difficulties can arise with GMM making it not possible or very difficult.</p>
<ul class="simple">
<li><p>The model moment function <span class="math notranslate nohighlight">\(m(x|\theta)\)</span> is not known analytically.</p></li>
<li><p>The data moments you are trying to match come from another model (indirect inference, see <span id="id6">[<a class="reference internal" href="../CompMethods_references.html#id19" title="Anthony A. Jr. Smith. Indirect inference. In Matias Vernengo, Esteban Perez Caldentey, and Barkley J. Rosser Jr., editors, New Palgrave Dictionary of Economics. Palgrave MacMillan, 2020. URL: http://www.econ.yale.edu/smith/palgrave7.pdf.">Smith, 2020</a>]</span>).</p></li>
<li><p>The model moments <span class="math notranslate nohighlight">\(m(x|\theta)\)</span> are derived from <em>latent variables</em> that are not observed by the modeler. You only have moments, not the underlying data. See <span id="id7">[<a class="reference internal" href="../CompMethods_references.html#id14" title="G. Laroque and B. Salanié. Simulation based estimation models with lagged latent variables. Journal of Applied Econometrics, 8(Supplement):119-133, December 1993.">Laroque and Salanié, 1993</a>]</span>.</p></li>
<li><p>The model moments <span class="math notranslate nohighlight">\(m(x|\theta)\)</span> are derived from <em>censored variables</em> that are only partially observed by the modeler.</p></li>
<li><p>The model moments <span class="math notranslate nohighlight">\(m(x|\theta)\)</span> are just difficult to derive analytically. Examples include moments that include multiple integrals over nonlinear functions as in <span id="id8">[<a class="reference internal" href="../CompMethods_references.html#id16" title="Daniel McFadden. A method of simulated moments for estimation of discrete response models without numerical integration. Econometrica, 57(5):995-1026, September 1989.">McFadden, 1989</a>]</span>.</p></li>
</ul>
<p>SMM estimation is simply to simulate the model data <span class="math notranslate nohighlight">\(S\)</span> times, and use the average values of the moments from the simulated data as the estimator for the model moments. Let <span class="math notranslate nohighlight">\(\tilde{x}\equiv\{\tilde{x}_1,\tilde{x}_2,...\tilde{x}_s,...\tilde{x}_S\}\)</span> be the <span class="math notranslate nohighlight">\(S\)</span> simulations of the model data. And let the maximization problem in <a class="reference internal" href="#equation-eqsmm-smmestimator">(9)</a> be characterized by <span class="math notranslate nohighlight">\(R\)</span> average moments across simulations, where <span class="math notranslate nohighlight">\(\hat{m}_r\)</span> is the average value of the <span class="math notranslate nohighlight">\(r\)</span>th moment across the <span class="math notranslate nohighlight">\(S\)</span> simulations where,</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-avgsimmoms-r">
<span class="eqno">(7)<a class="headerlink" href="#equation-eqsmm-avgsimmoms-r" title="Permalink to this equation">#</a></span>\[    \hat{m}_r\left(\tilde{x}|\theta\right) = \frac{1}{S}\sum_{s=1}^S m_r\left(\tilde{x}_s|\theta\right)\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-avgsimmoms-vec">
<span class="eqno">(8)<a class="headerlink" href="#equation-eqsmm-avgsimmoms-vec" title="Permalink to this equation">#</a></span>\[    \hat{m}\left(\tilde{x}|\theta\right) = \left[m_1\left(\tilde{x}|\theta\right), m_2\left(\tilde{x}|\theta\right),...m_R\left(\tilde{x}|\theta\right)\right]^T\]</div>
<p>Once we have an estimate of the vector of <span class="math notranslate nohighlight">\(R\)</span> average model moments <span class="math notranslate nohighlight">\(\hat{m}\left(\tilde{x}|\theta\right)\)</span> from our <span class="math notranslate nohighlight">\(S\)</span> simulations, SMM estimation is very similar to our presentation of GMM in <a class="reference internal" href="GMM.html#chap-gmm"><span class="std std-ref">Generalized Method of Moments Estimation</span></a>. The SMM approach of estimating the <span class="math notranslate nohighlight">\(K\times 1\)</span> parameter vector <span class="math notranslate nohighlight">\(\hat{\theta}_{SMM}\)</span> is to choose vector <span class="math notranslate nohighlight">\(\theta\)</span> to minimize some distance measure of the <span class="math notranslate nohighlight">\(R\)</span> data moments <span class="math notranslate nohighlight">\(m(x)\)</span> from the <span class="math notranslate nohighlight">\(R\)</span> simulated average model moments <span class="math notranslate nohighlight">\(\hat{m}(\tilde{x}|\theta)\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-smmestimator">
<span class="eqno">(9)<a class="headerlink" href="#equation-eqsmm-smmestimator" title="Permalink to this equation">#</a></span>\[    \hat{\theta}_{SMM}=\theta:\quad \min_{\theta}\: ||\hat{m}(\tilde{x}|\theta)-m(x)||\]</div>
<p>The distance measure <span class="math notranslate nohighlight">\(||\hat{m}(\tilde{x}|\theta)-m(x)||\)</span> can be any kind of norm. But it is important to recognize that your estimates <span class="math notranslate nohighlight">\(\hat{\theta}_{SMM}\)</span> will be dependent on what distance measure (norm) you choose. The most widely studied and used distance metric in GMM and SMM estimation is the <span class="math notranslate nohighlight">\(L^2\)</span> norm or the sum of squared errors in moments.</p>
<p>Define the moment error vector <span class="math notranslate nohighlight">\(e(\tilde{x},x|\theta)\)</span> as the <span class="math notranslate nohighlight">\(R\times 1\)</span> vector of average moment error functions <span class="math notranslate nohighlight">\(e_r(\tilde{x},x|\theta)\)</span> of the <span class="math notranslate nohighlight">\(r\)</span>th average moment error. We can define the <span class="math notranslate nohighlight">\(r\)</span>th average moment error as the percent difference in the average simulated <span class="math notranslate nohighlight">\(r\)</span>th moment value <span class="math notranslate nohighlight">\(\hat{m}_r(\tilde{x}|\theta)\)</span> from the <span class="math notranslate nohighlight">\(r\)</span>th data moment <span class="math notranslate nohighlight">\(m_r(x)\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-rmomerror">
<span class="eqno">(10)<a class="headerlink" href="#equation-eqsmm-rmomerror" title="Permalink to this equation">#</a></span>\[    e_r(\tilde{x},x|\theta) \equiv \frac{\hat{m}_r(\tilde{x}|\theta)-m_r(x)}{m_r(x)} \quad\text{or}\quad \hat{m}_r(\tilde{x}|\theta)-m_r(x)\]</div>
<p>It is important that the error function <span class="math notranslate nohighlight">\(e(\tilde{x},x|\theta)\)</span> be a percent deviation of the moments (given that none of the data moments are 0). This puts all the moments in the same units, which helps make sure that no moments receive unintended weighting simply due to its units. This ensures that the problem is scaled properly and will suffer from as little as possible ill conditioning.</p>
<p>In this case, the SMM estimator is the following,</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-smmestgen">
<span class="eqno">(11)<a class="headerlink" href="#equation-eqsmm-smmestgen" title="Permalink to this equation">#</a></span>\[    \hat{\theta}_{SMM}=\theta:\quad \min_{\theta}\:e(\tilde{x},x|\theta)^T \, W \, e(\tilde{x},x|\theta)\]</div>
<p>where <span class="math notranslate nohighlight">\(W\)</span> is a <span class="math notranslate nohighlight">\(R\times R\)</span> weighting matrix in the criterion function. For now, think of this weighting matrix as the identity matrix. But we will show in Section <a class="reference internal" href="#secsmm-weightmatw"><span class="std std-ref">The Weighting Matrix (W)</span></a> a more optimal weighting matrix. We call the quadratic form expression <span class="math notranslate nohighlight">\(e(\tilde{x},x|\theta)^T \, W \, e(\tilde{x},x|\theta)\)</span> the <em>criterion function</em> because it is a strictly positive scalar that is the object of the minimization in the SMM problem statement. The <span class="math notranslate nohighlight">\(R\times R\)</span> weighting matrix <span class="math notranslate nohighlight">\(W\)</span> in the criterion function allows the econometrician to control how each moment is weighted in the minimization problem. For example, an <span class="math notranslate nohighlight">\(R\times R\)</span> identity matrix for <span class="math notranslate nohighlight">\(W\)</span> would give each moment equal weighting, and the criterion function would be a simply sum of squared percent deviations (errors). Other weighting strategies can be dictated by the nature of the problem or model.</p>
<p>One last item to emphasize with SMM, which we will highlight in the examples in this chapter, is that the errors that are drawn for the <span class="math notranslate nohighlight">\(S\)</span> simulations of the model must be drawn only once so that the minimization problem for estimating <span class="math notranslate nohighlight">\(\hat{\theta}_{SMM}\)</span> does not have the underlying sampling changing for each guess of a value of <span class="math notranslate nohighlight">\(\theta\)</span>. Put more simply, you want the random draws for all the simulations to be held constant so that the only thing changing in the minimization problem is the value of the vector of parameters <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
</section>
<section id="the-weighting-matrix-w">
<span id="secsmm-weightmatw"></span><h2>The Weighting Matrix (W)<a class="headerlink" href="#the-weighting-matrix-w" title="Permalink to this heading">#</a></h2>
<p>In the SMM criterion function in the problem statement above, some weighting matrices <span class="math notranslate nohighlight">\(W\)</span> produce precise estimates while others produce poor estimates with large variances. We want to choose the optimal weighting matrix <span class="math notranslate nohighlight">\(W\)</span> with the smallest possible asymptotic variance. This is an efficient or optimal SMM estimator. The optimal weighting matrix is the inverse variance covariance matrix of the moments at the optimal moments,</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-estw-opt">
<span class="eqno">(12)<a class="headerlink" href="#equation-eqsmm-estw-opt" title="Permalink to this equation">#</a></span>\[    W^{opt} \equiv \Omega^{-1}(\tilde{x},x|\hat{\theta}_{SMM})\]</div>
<p>where <span class="math notranslate nohighlight">\(\Omega(\tilde{x},x|\theta)\)</span> is the variance covariance matrix of the moment condition errors <span class="math notranslate nohighlight">\(e(\tilde{x},x|\theta)\)</span>. The intuition for using the inverse variance covariance matrix <span class="math notranslate nohighlight">\(\Omega^{-1}\)</span> as the optimal weighting matrix is the following. You want to downweight moments that have a high variance, and you want to weight more heavily the moments that are generated more precisely.</p>
<p>Notice that this definition of the optimal weighting matrix is circular. <span class="math notranslate nohighlight">\(W^{opt}\)</span> is a function of the SMM estimates <span class="math notranslate nohighlight">\(\hat{\theta}_{SMM}\)</span>, but the optimal weighting matrix is used in the estimation of <span class="math notranslate nohighlight">\(\hat{\theta}_{SMM}\)</span>. This means that one has to use some kind of iterative fixed point method to find the true optimal weighting matrix <span class="math notranslate nohighlight">\(W^{opt}\)</span>. Below are some examples of weighting matrices to use.</p>
<section id="the-identity-matrix-w-i">
<span id="secsmm-w-i"></span><h3>The identity matrix (W=I)<a class="headerlink" href="#the-identity-matrix-w-i" title="Permalink to this heading">#</a></h3>
<p>Many times, you can get away with just using the identity matrix as your weighting matrix <span class="math notranslate nohighlight">\(W = I\)</span>. This changes the criterion function to a simple sum of squared error functions such that each moment has the same weight.</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-estw-i">
<span class="eqno">(13)<a class="headerlink" href="#equation-eqsmm-estw-i" title="Permalink to this equation">#</a></span>\[    \hat{\theta}_{SMM}=\theta:\quad \min_{\theta}\:e(\tilde{x},x|\theta)^T \, e(\tilde{x},x|\theta)\]</div>
<p>If the problem is well conditioned and well identified, then your SMM estimates <span class="math notranslate nohighlight">\(\hat{\theta}_{SMM}\)</span> will not be greatly affected by this simplest of weighting matrices.</p>
</section>
<section id="two-step-variance-covariance-estimator-of-w">
<span id="secsmm-w-2step"></span><h3>Two-step variance-covariance estimator of W<a class="headerlink" href="#two-step-variance-covariance-estimator-of-w" title="Permalink to this heading">#</a></h3>
<p>The most common method of estimating the optimal weighting matrix for SMM estimates is the two-step variance covariance estimator. The name “two-step” refers to the two steps used to get the weighting matrix.</p>
<p>The first step is to estimate the SMM parameter vector <span class="math notranslate nohighlight">\(\hat{\theta}_{1,SMM}\)</span> using the simple identity matrix as the weighting matrix <span class="math notranslate nohighlight">\(W = I\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-estw-2step-1">
<span class="eqno">(14)<a class="headerlink" href="#equation-eqsmm-estw-2step-1" title="Permalink to this equation">#</a></span>\[    \hat{\theta}_{1,SMM}=\theta:\quad \min_{\theta}\:e(\tilde{x},x|\theta)^T \, I \, e(\tilde{x},x|\theta)\]</div>
<p>Because we are simulating data, we can generate an estimator for the variance covariance matrix of the moment error vector <span class="math notranslate nohighlight">\(\hat{\Omega}\)</span> using just the simulated data moments and the data moments. This <span class="math notranslate nohighlight">\(E(\tilde{x},x|\theta)\)</span> matrix represents the contribution of the <span class="math notranslate nohighlight">\(s\)</span>th simulated moment to the <span class="math notranslate nohighlight">\(r\)</span>th moment error. Define <span class="math notranslate nohighlight">\(E(\tilde{x},x|\theta)\)</span> as the <span class="math notranslate nohighlight">\(R\times S\)</span> matrix of moment error functions from each simulation.</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-estw-errmat-lev-1">
<span class="eqno">(15)<a class="headerlink" href="#equation-eqsmm-estw-errmat-lev-1" title="Permalink to this equation">#</a></span>\[    ?\]</div>
<p>text</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-estw-errmat-pct-1">
<span class="eqno">(16)<a class="headerlink" href="#equation-eqsmm-estw-errmat-pct-1" title="Permalink to this equation">#</a></span>\[    ?\]</div>
<p>text</p>
</section>
<section id="iterated-variance-covariance-estimator-of-w">
<span id="secsmm-w-iter"></span><h3>Iterated variance-covariance estimator of W<a class="headerlink" href="#iterated-variance-covariance-estimator-of-w" title="Permalink to this heading">#</a></h3>
</section>
<section id="newey-west-consistent-estimator-of-omega-and-w">
<span id="secsmm-w-nw"></span><h3>Newey-West consistent estimator of <span class="math notranslate nohighlight">\(\Omega\)</span> and W<a class="headerlink" href="#newey-west-consistent-estimator-of-omega-and-w" title="Permalink to this heading">#</a></h3>
</section>
</section>
<section id="the-smm-variance-covariance-estimator-of-the-estimated-parameters">
<span id="secsmm-varcov"></span><h2>The SMM Variance-Covariance Estimator of the Estimated Parameters<a class="headerlink" href="#the-smm-variance-covariance-estimator-of-the-estimated-parameters" title="Permalink to this heading">#</a></h2>
</section>
<section id="examples">
<span id="secsmm-exmp"></span><h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h2>
</section>
<section id="exercises">
<span id="secsmm-exerc"></span><h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="ExercStructEst_SMM_BM72">

<p class="admonition-title"><span class="caption-number">Exercise 3 </span></p>
<section id="exercise-content">
<p><strong>Estimating the Brock and Mirman (1972) model by SMM.</strong> You can observe time series data in an economy for the following variables: <span class="math notranslate nohighlight">\((c_t, k_t, w_t, r_t, y_t)\)</span>. The data can be loaded from the file <a class="reference external" href="https://github.com/OpenSourceEcon/CompMethods/blob/main/data/smm/NewMacroSeries.txt"><code class="docutils literal notranslate"><span class="pre">NewMacroSeries.txt</span></code></a> in the online book repository data folder <code class="docutils literal notranslate"><span class="pre">data/smm/</span></code>. This file is a comma separated text file with no labels. The variables are ordered as <span class="math notranslate nohighlight">\((c_t, k_t, w_t, r_t, y_t)\)</span>. These data have 100 periods, which are quarterly (25 years). Suppose you think that the data are generated by a process similar to the <span id="id9">[<a class="reference internal" href="../CompMethods_references.html#id3" title="William A. Brock and Leonard J. Mirman. Optimal economic growth and uncertainty: the discounted case. Journal of Economic Theory, 4(3):479-513, June 1972.">Brock and Mirman, 1972</a>]</span> paper. A simplified set of characterizing equations of the Brock and Mirman model are the following six equations.</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-bm72-eul">
<span class="eqno">(17)<a class="headerlink" href="#equation-eqsmm-bm72-eul" title="Permalink to this equation">#</a></span>\[    (c_t)^{-1} - \beta E\left[r_{t+1}(c_{t+1})^{-1}\right] = 0\]</div>
<div class="math notranslate nohighlight" id="equation-eqsmm-bm72-bc">
<span class="eqno">(18)<a class="headerlink" href="#equation-eqsmm-bm72-bc" title="Permalink to this equation">#</a></span>\[    c_t + k_{t+1} - w_t - r_t k_t = 0\]</div>
<div class="math notranslate nohighlight" id="equation-eqsmm-bm72-focl">
<span class="eqno">(19)<a class="headerlink" href="#equation-eqsmm-bm72-focl" title="Permalink to this equation">#</a></span>\[    w_t - (1-\alpha)e^{z_t}(k_t)^\alpha = 0\]</div>
<div class="math notranslate nohighlight" id="equation-eqsmm-bm72-fock">
<span class="eqno">(20)<a class="headerlink" href="#equation-eqsmm-bm72-fock" title="Permalink to this equation">#</a></span>\[    r_t - \alpha e^{z_t}(k_t)^{\alpha-1} = 0\]</div>
<div class="math notranslate nohighlight" id="equation-eqsmm-bm72-zt">
<span class="eqno">(21)<a class="headerlink" href="#equation-eqsmm-bm72-zt" title="Permalink to this equation">#</a></span>\[    z_t = \rho z_{t-1} + (1-\rho)\mu + \varepsilon_t \quad\text{where}\quad \varepsilon_t\sim N(0,\sigma^2)\]</div>
<div class="math notranslate nohighlight" id="equation-eqsmm-bm72-prod">
<span class="eqno">(22)<a class="headerlink" href="#equation-eqsmm-bm72-prod" title="Permalink to this equation">#</a></span>\[    y_t = e^{z_t}(k_t)^\alpha\]</div>
<p>The variable <span class="math notranslate nohighlight">\(c_t\)</span> is aggregate consumption in period <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(k_{t+1}\)</span> is total household savings and investment in period <span class="math notranslate nohighlight">\(t\)</span> for which they receive a return in the next period <span class="math notranslate nohighlight">\(t+1\)</span> (this model assumes full depreciation of capital). The wage per unit of labor in period <span class="math notranslate nohighlight">\(t\)</span> is <span class="math notranslate nohighlight">\(w_t\)</span>, and the interest rate or rate of return on investment is
<span class="math notranslate nohighlight">\(r_t\)</span>. Total factor productivity is <span class="math notranslate nohighlight">\(z_t\)</span>, which follows an AR(1) process given in <a class="reference internal" href="#equation-eqsmm-bm72-zt">(21)</a>. GDP is <span class="math notranslate nohighlight">\(y_t\)</span>. The rest of the symbols in the equations are parameters that must be estimated or calibrated <span class="math notranslate nohighlight">\((\alpha, \beta, \rho, \mu, \sigma)\)</span>. The constraints on these parameters are the following.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
  \alpha,\beta \in (0,1),\quad \mu,\sigma &gt; 0, \quad\rho\in(-1,1)
\end{equation*}\]</div>
<p>Assume that the first observation in the data file variables is <span class="math notranslate nohighlight">\(t=1\)</span>. Let <span class="math notranslate nohighlight">\(k_1\)</span> be the first observation in the data fil for the variable <span class="math notranslate nohighlight">\(k_t\)</span>. One nice property of the <span id="id10">[<a class="reference internal" href="../CompMethods_references.html#id3" title="William A. Brock and Leonard J. Mirman. Optimal economic growth and uncertainty: the discounted case. Journal of Economic Theory, 4(3):479-513, June 1972.">Brock and Mirman, 1972</a>]</span> model is that the household decision has a known analytical solution in which the optimal savings decision <span class="math notranslate nohighlight">\(k_{t+1}\)</span> is a function of the productivity shock today <span class="math notranslate nohighlight">\(z_t\)</span> and the amount of capital today <span class="math notranslate nohighlight">\(k_t\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eqsmm-bm72-pf">
<span class="eqno">(23)<a class="headerlink" href="#equation-eqsmm-bm72-pf" title="Permalink to this equation">#</a></span>\[    k_{t+1} = \alpha\beta e^{z_t}(k_t)^\alpha\]</div>
<p>With this solution <a class="reference internal" href="#equation-eqsmm-bm72-pf">(23)</a> and equations <a class="reference internal" href="#equation-eqsmm-bm72-bc">(18)</a> through <a class="reference internal" href="#equation-eqsmm-bm72-zt">(21)</a>, it is straightforward to simulate the data of the <span id="id11">[<a class="reference internal" href="../CompMethods_references.html#id3" title="William A. Brock and Leonard J. Mirman. Optimal economic growth and uncertainty: the discounted case. Journal of Economic Theory, 4(3):479-513, June 1972.">Brock and Mirman, 1972</a>]</span> model given parameters <span class="math notranslate nohighlight">\((\alpha, \beta, \rho, \mu, \sigma)\)</span>.</p>
<p>First, assume that <span class="math notranslate nohighlight">\(z_0=\mu\)</span> and that <span class="math notranslate nohighlight">\(k_1=\text{mean}(k_t)\)</span> from the data. These are initial values that will not change across simulations. Also assume that <span class="math notranslate nohighlight">\(\beta=0.99\)</span>.</p>
<p>Next, draw a matrix of <span class="math notranslate nohighlight">\(S=1,000\)</span> simulations (columns) of <span class="math notranslate nohighlight">\(T=100\)</span> (rows) from a uniform distribution <span class="math notranslate nohighlight">\(u_{s,t}\sim U(0,1)\)</span>. These draws will not change across this SMM estimation procedure.</p>
<p>For each guess of the parameter vector <span class="math notranslate nohighlight">\((\alpha,\rho,\mu,\sigma)\)</span> given <span class="math notranslate nohighlight">\(\beta=0.99\)</span>, you can use <span class="math notranslate nohighlight">\(u_{s,t}\)</span> to generate normally distributed errors <span class="math notranslate nohighlight">\(\varepsilon_{s,t}\sim N(0,\sigma^2)\)</span> using the inverse cdf of the normal distribution, where <span class="math notranslate nohighlight">\(s\)</span> is the index of the simulation number (columns).</p>
<p>With <span class="math notranslate nohighlight">\(\varepsilon_{s,t}\)</span>, <span class="math notranslate nohighlight">\(\rho\)</span>, <span class="math notranslate nohighlight">\(\mu\)</span>, and <span class="math notranslate nohighlight">\(z_0=\mu\)</span>, you can use <a class="reference internal" href="#equation-eqsmm-bm72-zt">(21)</a> to generate the simulationed values for <span class="math notranslate nohighlight">\(z_{s,t}\)</span>.</p>
<p>With <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta=0.99\)</span>, <span class="math notranslate nohighlight">\(z_{s,t}\)</span>, and <span class="math notranslate nohighlight">\(k_1\)</span>, you can use <a class="reference internal" href="#equation-eqsmm-bm72-pf">(23)</a> to generate simulated values for <span class="math notranslate nohighlight">\(k_{t+1}\)</span>.</p>
<p>With <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(z_{s,t}\)</span>, and <span class="math notranslate nohighlight">\(k_{s,t}\)</span>, you can use <a class="reference internal" href="#equation-eqsmm-bm72-focl">(19)</a> and <a class="reference internal" href="#equation-eqsmm-bm72-fock">(20)</a> to generate simulated values for <span class="math notranslate nohighlight">\(w_{s,t}\)</span> and <span class="math notranslate nohighlight">\(r_{s,t}\)</span>, respectively.</p>
<p>With <span class="math notranslate nohighlight">\(w_{s,t}\)</span>, <span class="math notranslate nohighlight">\(r_{s,t}\)</span>, and <span class="math notranslate nohighlight">\(k_{s,t}\)</span>, you can use <a class="reference internal" href="#equation-eqsmm-bm72-bc">(18)</a> to generate simulated values for <span class="math notranslate nohighlight">\(c_{s,t}\)</span>.</p>
<p>With <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(z_{s,t}\)</span>, and <span class="math notranslate nohighlight">\(k_{s,t}\)</span>, you can use <a class="reference internal" href="#equation-eqsmm-bm72-prod">(22)</a> to generate simulated values for <span class="math notranslate nohighlight">\(y_{s,t}\)</span>.</p>
<ol class="arabic simple">
<li><p>Estimate four parameters <span class="math notranslate nohighlight">\((\alpha, \rho,\mu,\sigma)\)</span> given <span class="math notranslate nohighlight">\(\beta=0.99\)</span> of the <span id="id12">[<a class="reference internal" href="../CompMethods_references.html#id3" title="William A. Brock and Leonard J. Mirman. Optimal economic growth and uncertainty: the discounted case. Journal of Economic Theory, 4(3):479-513, June 1972.">Brock and Mirman, 1972</a>]</span> model described by equations <a class="reference internal" href="#equation-eqsmm-bm72-eul">(17)</a> through <a class="reference internal" href="#equation-eqsmm-bm72-prod">(22)</a> and <a class="reference internal" href="#equation-eqsmm-bm72-pf">(23)</a> by SMM. Choose the four parameters to match the following six moments from the 100 periods of empirical data <span class="math notranslate nohighlight">\(\{c_t,k_t, w_t, r_t, y_t\}_{t=1}^{100}\)</span> in <a class="reference external" href="https://github.com/OpenSourceEcon/CompMethods/blob/main/data/smm/NewMacroSeries.txt"><code class="docutils literal notranslate"><span class="pre">NewMacroSeries.txt</span></code></a>: <span class="math notranslate nohighlight">\(\text{mean}(c_t)\)</span>, <span class="math notranslate nohighlight">\(\text{mean}(k_t)\)</span>, <span class="math notranslate nohighlight">\(\text{mean}(c_t/y_t)\)</span>, <span class="math notranslate nohighlight">\(\text{var}(y_t)\)</span>, <span class="math notranslate nohighlight">\(\text{corr}(c_t, c_{t-1})\)</span>, <span class="math notranslate nohighlight">\(\text{corr}(c_t, k_t)\)</span>. In your simulations of the model, set <span class="math notranslate nohighlight">\(T=100\)</span> and <span class="math notranslate nohighlight">\(S=1,000\)</span>. Input the bounds to be <span class="math notranslate nohighlight">\(\alpha\in[0.01,0.99]\)</span>, <span class="math notranslate nohighlight">\(\rho\in[-0.99,0.99]\)</span>, <span class="math notranslate nohighlight">\(\mu\in[5, 14]\)</span>, and <span class="math notranslate nohighlight">\(\sigma\in[0.01, 1.1]\)</span>.
Also, use the identity matrix as your weighting matrix <span class="math notranslate nohighlight">\(\textbf{W}=\textbf{I}\)</span> as shown in section <a class="reference internal" href="#secsmm-w-i"><span class="std std-ref">The identity matrix (W=I)</span></a>. Report your solution <span class="math notranslate nohighlight">\(\hat{\theta} = \left(\hat{\alpha},\hat{\rho},\hat{\mu},\hat{\sigma}\right)\)</span>, the vector of moment differences at the optimum, and the criterion function value. Also report your standard errors for the estimated parameter vector <span class="math notranslate nohighlight">\(\hat{\theta} = \left(\hat{\alpha},\hat{\rho},\hat{\mu},\hat{\sigma}\right)\)</span> based on the identity matrix for the optimal weighting matrix.</p></li>
<li><p>Perform the estimation using the two-step estimator for the optimal weighting matrix <span class="math notranslate nohighlight">\(\textbf{W}_{2step}\)</span>, as shown in section <a class="reference internal" href="#secsmm-w-2step"><span class="std std-ref">Two-step variance-covariance estimator of W</span></a>. Report your solution <span class="math notranslate nohighlight">\(\hat{\theta} = \left(\hat{\alpha},\hat{\rho},\hat{\mu},\hat{\sigma}\right)\)</span>, the vector of moment differences at the optimum, and the criterion function value. Also report your standard errors for the estimated parameter vector <span class="math notranslate nohighlight">\(\hat{\theta} = \left(\hat{\alpha},\hat{\rho},\hat{\mu},\hat{\sigma}\right)\)</span> based on the two-step optimal weighting matrix <span class="math notranslate nohighlight">\(\textbf{W}_{2step}\)</span>.</p></li>
</ol>
</section>
</div>
</section>
<section id="footnotes">
<span id="secsmmfootnotes"></span><h2>Footnotes<a class="headerlink" href="#footnotes" title="Permalink to this heading">#</a></h2>
<!-- [^citation_note]: See {cite}`AuerbachEtAl:1981,AuerbachEtAl:1983`, {cite}`AuerbachKotlikoff:1983a,AuerbachKotlikoff:1983b,AuerbachKotlikoff:1983c`, and {cite}`AuerbachKotlikoff:1985`. -->
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./struct_est"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="GMM.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Generalized Method of Moments Estimation</p>
      </div>
    </a>
    <a class="right-next"
       href="../appendix/glossary.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Glossary</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-smm-estimator">The SMM estimator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-weighting-matrix-w">The Weighting Matrix (W)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-identity-matrix-w-i">The identity matrix (W=I)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-step-variance-covariance-estimator-of-w">Two-step variance-covariance estimator of W</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iterated-variance-covariance-estimator-of-w">Iterated variance-covariance estimator of W</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#newey-west-consistent-estimator-of-omega-and-w">Newey-West consistent estimator of <span class="math notranslate nohighlight">\(\Omega\)</span> and W</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-smm-variance-covariance-estimator-of-the-estimated-parameters">The SMM Variance-Covariance Estimator of the Estimated Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#footnotes">Footnotes</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Richard W. Evans
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>